â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                    ğŸš€ ä»è¿™é‡Œå¼€å§‹ - å¿«é€Ÿä¸Šæ‰‹æŒ‡å—                           â•‘
â•‘                        Version 2.5 FINAL                                  â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ… æ‚¨çš„ä»£ç ç°åœ¨100%ç¬¦åˆNature Human Behaviour 2024æ ‡å‡†ï¼

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  ç¬¬ä¸€æ­¥ï¼šå®‰è£…MRlapåŒ…ï¼ˆæœ€åä¸€ä¸ªå¿…éœ€åŒ…ï¼‰                                    â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

åœ¨Rä¸­è¿è¡Œï¼š
  install.packages("devtools")
  devtools::install_github("n-mounier/MRlap")
  library(MRlap)  # éªŒè¯å®‰è£…æˆåŠŸ

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  ç¬¬äºŒæ­¥ï¼šé…ç½®æ ·æœ¬é‡å ï¼ˆå¯é€‰ä½†æ¨èï¼‰                                        â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

æ‰“å¼€æ–‡ä»¶ï¼šsample_overlap_config.csv

å¡«å†™ç¤ºä¾‹ï¼š
  exposure_file,outcome_file,n_exposure,n_outcome,n_overlap,notes
  ProteinA.tsv,AD37.tsv,500000,480000,0,Different cohorts
  ProteinB.tsv,Healthspan.tsv,400000,300447,280000,Both UK Biobank

å¦‚æœä¸ç¡®å®šé‡å ï¼Œå…¨éƒ¨è®¾ä¸º0å³å¯ï¼ˆä¿å®ˆï¼‰ã€‚

ä¸å¡«å†™ä¹Ÿå¯ä»¥è¿è¡Œï¼ŒMRlapä¼šå°è¯•è‡ªåŠ¨æ£€æµ‹ã€‚

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  ç¬¬ä¸‰æ­¥ï¼šæµ‹è¯•è®¾ç½®ï¼ˆæ¨èï¼‰                                                  â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

source("Test_Covariate_Loading.R")

åº”è¯¥çœ‹åˆ°ï¼š
  âœ“âœ“âœ“ EXCELLENT! All 3 covariate files are ready!

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  ç¬¬å››æ­¥ï¼šè¿è¡Œå®Œæ•´åˆ†æ                                                      â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

source("Main analysis.R")

ä¼šè‡ªåŠ¨è¿è¡Œï¼š
  âœ“ UVMRï¼ˆ5ç§æ–¹æ³• + MRlap + FDRæ ¡æ­£ + æ–¹æ³•éªŒè¯ï¼‰
  âœ“ MVMRï¼ˆ4ç§æ–¹æ³• + SESè°ƒæ•´ + FDRæ ¡æ­£ï¼‰
  âœ“ ä¸­ä»‹åˆ†æï¼ˆå«Reverse MR + æ–¹å‘æ£€æŸ¥ + FDRæ ¡æ­£ï¼‰

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  ç¬¬äº”æ­¥ï¼šç­›é€‰æ˜¾è‘—ç»“æœ                                                      â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

source("Results_Filter_Helper.R")
generate_summary_report()

æˆ–æ‰‹åŠ¨ç­›é€‰ï¼š
  library(data.table)
  
  # UVMRç¨³å¥ç»“æœ
  uvmr <- fread("results_trial/uvmr_comprehensive_results.csv")
  robust <- uvmr[grepl("IVW",method) & q_value<0.05 & concordance_validated==TRUE]
  
  # MVMRç‹¬ç«‹æ•ˆåº”
  mvmr <- fread("results_trial/mvmr_comprehensive_results.csv")
  independent <- mvmr[method=="MVMR-IVW" & q_value<0.05 & n_covariates==3]
  
  # æœ‰æ•ˆä¸­ä»‹
  med <- fread("results_trial/mediation_comprehensive_results.csv")
  valid <- med[pval_exp_med<0.05 & pval_med_out_direct<0.05 & 
               bidirectional=="No_Unidirectional" & direction_concordant==TRUE]

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  æ£€æŸ¥æ¸…å•ï¼ˆè¿è¡ŒåéªŒè¯ï¼‰                                                    â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

æ§åˆ¶å°è¾“å‡ºï¼š
  â–¡ "MVMR:        âœ“ Loaded" â† å¿…é¡»çœ‹åˆ°
  â–¡ "MRlap:       âœ“ Loaded" â† å¿…é¡»çœ‹åˆ°
  â–¡ "Covariates found: 3 files" â† å¿…é¡»çœ‹åˆ°
  â–¡ "Total covariates loaded: 3" â† å¿…é¡»çœ‹åˆ°
  â–¡ "Running MRlap analysis..." â† åº”è¯¥çœ‹åˆ°
  â–¡ "Testing reverse causation (Med â†’ Exp)..." â† åº”è¯¥çœ‹åˆ°

UVMRç»“æœï¼š
  â–¡ æœ‰q_valueåˆ—ï¼ˆFDRæ ¡æ­£ï¼‰
  â–¡ æœ‰concordance_validatedåˆ—ï¼ˆæ–¹æ³•éªŒè¯ï¼‰
  â–¡ æœ‰mrlap_beta, mrlap_pvalåˆ—ï¼ˆMRlapç»“æœï¼‰
  â–¡ æœ‰mrlap_statusåˆ—ï¼ˆå¤§éƒ¨åˆ†æ˜¯"Success"ï¼‰

MVMRç»“æœï¼š
  â–¡ æœ‰methodåˆ—ï¼ˆ4ç§æ–¹æ³•ï¼‰
  â–¡ æœ‰adjusted_foråˆ—ï¼ˆåŒ…å«Education;Income;Occupationï¼‰
  â–¡ æœ‰n_covariatesåˆ—ï¼ˆå…¨éƒ¨=3ï¼‰
  â–¡ æœ‰q_valueåˆ—ï¼ˆFDRæ ¡æ­£ï¼‰

ä¸­ä»‹ç»“æœï¼š
  â–¡ æœ‰bidirectionalåˆ—ï¼ˆå¤§éƒ¨åˆ†"No_Unidirectional"ï¼‰
  â–¡ æœ‰direction_concordantåˆ—ï¼ˆå¤§éƒ¨åˆ†TRUEï¼‰
  â–¡ æœ‰reverse_beta_med_expåˆ—ï¼ˆåå‘MRç»“æœï¼‰
  â–¡ æœ‰q_valueåˆ—ï¼ˆFDRæ ¡æ­£ï¼‰

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  ğŸ¯ æ‚¨ç°åœ¨çš„å®Œæ•´åŠŸèƒ½                                                       â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

3ç§æ ¸å¿ƒåˆ†æï¼šUVMR, MVMRï¼ˆSESè°ƒæ•´ï¼‰, ä¸­ä»‹åˆ†æ
9ç§MRæ–¹æ³•ï¼šIVW, Egger, Median, Modeç­‰ï¼ˆUVMRï¼‰+ 4ç§MVMRæ–¹æ³•
7ç§æ•æ„Ÿæ€§åˆ†æï¼šå¼‚è´¨æ€§ã€å¤šæ•ˆæ€§ã€å¼‚å¸¸å€¼ã€æ¡ä»¶Fã€æ–¹æ³•ä¸€è‡´æ€§ã€Reverse MRã€MRlap
3ç§éªŒè¯æœºåˆ¶ï¼šFDRæ ¡æ­£ã€æ–¹æ³•éªŒè¯ã€åŒå‘æ€§æ£€éªŒ
4ä¸ªå¿…éœ€RåŒ…ï¼šTwoSampleMR, MVMR, MRPRESSO, MRlapï¼ˆå…¨éƒ¨ä½¿ç”¨ï¼‰
å®Œæ•´çš„è‹±æ–‡æ³¨é‡Šï¼šæ¯ä¸ªå‡½æ•°éƒ½æœ‰è¯¦ç»†æ–‡æ¡£

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

                    ğŸ‰ 100%å®Œæˆï¼å¯ä»¥å¼€å§‹æ‚¨çš„ç ”ç©¶äº†ï¼

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ä¸‹ä¸€æ­¥ï¼š
  1. å®‰è£…MRlapï¼šdevtools::install_github("n-mounier/MRlap")
  2. ï¼ˆå¯é€‰ï¼‰é…ç½®sample_overlap_config.csv
  3. è¿è¡Œï¼šsource("Main analysis.R")
  4. æŸ¥çœ‹ç»“æœå¹¶å¯è§†åŒ–

é‡åˆ°é—®é¢˜ï¼ŸæŸ¥çœ‹è¯¦ç»†æ–‡æ¡£ï¼š
  â€¢ MRlap_SETUP_GUIDE.mdï¼ˆMRlapè®¾ç½®ï¼‰
  â€¢ âœ…FINAL_COMPLETE_GUIDE_v2.5.mdï¼ˆå®Œæ•´æŒ‡å—ï¼‰
  â€¢ METHOD_COMPLIANCE_CHECK_v2.5.mdï¼ˆåˆè§„æ€§æ£€æŸ¥ï¼‰




